syntax = "proto3";

package verifier;

service VerifierService {
  rpc Verify (VerifyRequest) returns (VerifyResponse);
}

message VerifyRequest {
  string code = 1;
  string language = 2;
  repeated string checks = 3; // e.g. ["syntax", "lint", "types"]
  repeated Contract contracts = 4;
}

message Contract {
    string type = 1; // precondition, postcondition
    string description = 2;
    string expression = 3;
}

message VerifyResponse {
  bool valid = 1;
  float score = 2; // 0.0 to 1.0
  repeated Issue issues = 3;
  repeated VerificationResult results = 4;
}

message VerificationResult {
    string check_name = 1;
    string status = 2; // passed, failed
    string message = 3;
    float score = 4;
    int32 tier = 5;
}

message Issue {
  string code = 1;
  string message = 2;
  string severity = 3; // "error", "warning", "info"
  int32 line = 4;
  int32 column = 5;
}
